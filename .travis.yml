sudo: required

language: cpp

compiler:
    - gcc
    - clang

services:
    - docker

env:
    - TEST_OS=fedora-27
    - TEST_OS=ubuntu-artful
    - TEST_OS=ubuntu-xenial
    - TEST_OS=ubuntu-trusty

before_install:
    - docker build -t icecream-sundae-$TEST_OS -f .travis/$TEST_OS/Dockerfile .

script:
    - docker run --rm icecream-sundae-$TEST_OS /bin/sh -c "CC=$CC CXX=$CXX
        meson -Db_ndebug=false -Dwerror=true -Db_sanitize=address,undefined .. &&
        ninja &&
        ninja test &&
        ninja install"
